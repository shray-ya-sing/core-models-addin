<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renewable Energy Project Finance Testing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
        }
        .intro {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        select {
            width: 100%;
            padding: 5px;
        }
        textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            min-height: 60px;
        }
        .save-btn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        .save-btn:hover {
            background-color: #45a049;
        }
        .nav-btn {
            display: inline-block;
            background-color: #3498db;
            color: white;
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            text-decoration: none;
            text-align: center;
            transition: background-color 0.3s;
        }
        .nav-btn:hover {
            background-color: #2980b9;
        }
        .nav-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .scenario-description {
            background-color: #e8f4fd;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 25px;
            border-left: 5px solid #3498db;
        }
        .modeling-challenge {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 5px solid #ffc107;
        }
        .evaluation-guidance {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0 25px 0;
            border-left: 5px solid #4caf50;
        }
    </style>
</head>
<body>
    <div class="nav-container">
        <a href="advanced-finance-testing-form.html" class="nav-btn">Back to Scenarios</a>
        <a href="testing-form.html" class="nav-btn">Main Testing Form</a>
        <a href="pe-carveout-testing.html" class="nav-btn">PE Carve-Out Testing</a>
    </div>
    
    <h1>Renewable Energy Project Finance Testing</h1>
    
    <div class="scenario-description">
        <h2>Complex Financial Modeling Scenario: Renewable Energy Portfolio Optimization</h2>
        <p>In this scenario, a renewable energy infrastructure fund is evaluating a portfolio of solar, wind, and battery storage projects across multiple regions. The fund needs to optimize capital allocation across these projects while navigating complex project finance structures, revenue models, and portfolio-level considerations.</p>
        
        <h3>Key Modeling Challenges</h3>
        <div class="modeling-challenge">
            <h4>1. Project Finance Structures</h4>
            <p>The financing involves tax equity partnerships with flip structures, Power Purchase Agreements (PPAs) with various terms and escalation rates, Production Tax Credits (PTCs) and Investment Tax Credits (ITCs), and development fees and milestone payments.</p>
        </div>
        
        <div class="modeling-challenge">
            <h4>2. Revenue Modeling Complexities</h4>
            <p>The revenue models must account for time-of-day pricing differentials, seasonal generation patterns, merchant tail pricing after PPA expiration, and curtailment risk and capacity factors.</p>
        </div>
        
        <div class="modeling-challenge">
            <h4>3. Debt Structuring</h4>
            <p>The debt structure includes back-leverage at portfolio level, project-level non-recourse debt, interest rate swaps and hedging mechanisms, and DSCR-based cash sweeps.</p>
        </div>
        
        <div class="modeling-challenge">
            <h4>4. Portfolio Optimization</h4>
            <p>The portfolio requires risk-adjusted return optimization, geographic diversification benefits, technology diversification, and construction timeline staggering.</p>
        </div>
        
        <div class="evaluation-guidance">
            <h3>What to Look For in Add-in Responses</h3>
            <p>When evaluating the add-in's performance on these test cases, look for:</p>
            <ul>
                <li>Understanding of project finance terminology and structures</li>
                <li>Ability to model complex cash flow waterfalls with multiple priorities</li>
                <li>Correct implementation of tax equity partnership structures</li>
                <li>Proper modeling of time-series data (generation profiles, pricing curves)</li>
                <li>Understanding of project-level vs. portfolio-level metrics</li>
                <li>Appropriate risk modeling and sensitivity analysis</li>
                <li>Integration of operational metrics with financial outcomes</li>
            </ul>
        </div>
    </div>
    
    <h2>Renewable Energy Project Finance Modeling</h2>
    <p>These tests evaluate the add-in's ability to model complex project finance structures for renewable energy projects.</p>
    <table>
        <tr>
            <th width="5%">#</th>
            <th width="50%">Test Query</th>
            <th width="15%">Result</th>
            <th width="30%">Feedback</th>
        </tr>
        <tr>
            <td>1</td>
            <td>Create a detailed cash flow model for a solar project with a 15-year PPA at $45/MWh with 2% annual escalation, followed by a 10-year merchant tail at forecasted market prices</td>
            <td>
                <select name="result-proj-1">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-1" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>2</td>
            <td>Model a tax equity partnership with a 99/1 initial split, flipping to 5/95 after the tax equity partner achieves a 7% IRR target, including ITC benefits and depreciation</td>
            <td>
                <select name="result-proj-2">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-2" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>3</td>
            <td>Create a model for non-recourse project debt with a DSCR-based cash sweep mechanism that triggers at 1.2x coverage and releases at 1.35x coverage</td>
            <td>
                <select name="result-proj-3">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-3" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>4</td>
            <td>Design a portfolio optimization model that allocates $500M across 12 renewable projects to maximize risk-adjusted returns, considering correlation between generation profiles</td>
            <td>
                <select name="result-proj-4">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-4" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>5</td>
            <td>Model revenue for a battery storage project with 4-hour duration, including energy arbitrage (buy low/sell high), capacity payments, and ancillary services</td>
            <td>
                <select name="result-proj-5">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-5" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>6</td>
            <td>Create a sensitivity analysis that compares project IRRs across various capacity factors (P50, P90, P99) and electricity price scenarios</td>
            <td>
                <select name="result-proj-6">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-6" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>7</td>
            <td>Model a construction financing facility with drawdown schedule tied to completion milestones and the conversion to term debt upon commercial operation</td>
            <td>
                <select name="result-proj-7">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-7" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>8</td>
            <td>Build a wind farm financial model that incorporates hourly generation profiles, wake effects, and monthly O&M expenses with major component replacements</td>
            <td>
                <select name="result-proj-8">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-8" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>9</td>
            <td>Create a levered and unlevered cash flow model for a portfolio of renewable assets with different COD dates, and calculate the blended WACC</td>
            <td>
                <select name="result-proj-9">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-9" placeholder="Your feedback..."></textarea></td>
        </tr>
        <tr>
            <td>10</td>
            <td>Model a hedging strategy for a renewable portfolio using a combination of fixed-price swaps, collars, and virtual PPAs with settlement calculations</td>
            <td>
                <select name="result-proj-10">
                    <option value="">Select...</option>
                    <option value="success">✅ Success</option>
                    <option value="partial">⚠️ Partial</option>
                    <option value="failure">❌ Failure</option>
                </select>
            </td>
            <td><textarea name="feedback-proj-10" placeholder="Your feedback..."></textarea></td>
        </tr>
    </table>
    
    <button class="save-btn" onclick="saveResults()">Save Results</button>
    
    <script>
        function saveResults() {
            // Collect all results
            const results = {};
            const selects = document.querySelectorAll('select');
            const textareas = document.querySelectorAll('textarea');
            
            selects.forEach(select => {
                if (select.name) {
                    results[select.name] = select.value;
                }
            });
            
            textareas.forEach(textarea => {
                if (textarea.name) {
                    results[textarea.name] = textarea.value;
                }
            });
            
            // Format the results for saving
            let resultText = "# Renewable Energy Project Finance Testing Results\n\n";
            
            // Add results for each test case
            for (let i = 1; i <= 10; i++) {
                const resultName = `result-proj-${i}`;
                const feedbackName = `feedback-proj-${i}`;
                
                const result = results[resultName] || "Not tested";
                const feedback = results[feedbackName] || "";
                
                // Get the test query text from the table
                const queryElement = document.querySelector(`table tr:nth-child(${i + 1}) td:nth-child(2)`);
                const query = queryElement ? queryElement.textContent : `Query ${i}`;
                
                resultText += `## Query ${i}: ${query}\n`;
                resultText += `Result: ${result}\n`;
                resultText += `Feedback: ${feedback}\n\n`;
            }
            
            // Create a download link for the results
            const blob = new Blob([resultText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'renewable_energy_testing_results.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('Results saved! You can find them in your downloads folder.');
        }
    </script>
</body>
</html>