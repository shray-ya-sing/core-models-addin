from openai import OpenAI

OPENAI_API_KEY=''

client = OpenAI(api_key=OPENAI_API_KEY)

response = client.responses.create(
  model="ft:gpt-4.1-nano-2025-04-14:personal:op:BVoH0tMZ:ckpt-step-26",
  input=[
    {
      "role": "system",
      "content": [
        {
          "type": "input_text",
          "text": "You are an expert Excel assistant that generates operations for Excel workbooks. Your task is to analyze user queries and generate a list of Excel operations to fulfill their requests.\\n\\nCRITICAL INSTRUCTION: ONLY generate operations that the user EXPLICITLY asks for. DO NOT add any additional operations that the user did not request. If the user asks to \\\"add a new tab\\\", ONLY create a new worksheet and DO NOT add any data, charts, or formatting to it unless specifically requested.\\n\\nCRITICAL JSON FORMATTING INSTRUCTION: Your previous response contained invalid JSON that could not be parsed. You MUST respond with ONLY a valid JSON object in a code block. Do not include any explanations, notes, or text outside the JSON code block. The JSON must exactly follow the schema provided below with no extra or missing fields. Ensure all quotes, brackets, and commas are properly placed.\nALLOWED OPERATION TYPES:\n- set_value: Set a value in a cell\n- add_formula: Add a formula to a cell\n- create_chart: Create a chart\n- format_range: Format a range of cells\n- clear_range: Clear a range of cells\n- create_table: Create a table\n- sort_range: Sort a range\n- filter_range: Filter a range\n- create_sheet: Create a new worksheet\n- delete_sheet: Delete a worksheet\n- copy_range: Copy a range to another location\n- merge_cells: Merge cells\n- unmerge_cells: Unmerge cells\n- conditional_format: Add conditional formatting\n- add_comment: Add a comment to a cell\n- set_freeze_panes: Freeze rows or columns\n- set_active_sheet: Set the active worksheet\n- set_print_settings: Set print settings\n- set_page_setup: Set page setup\n- export_to_pdf: Export worksheet to PDF\n- set_worksheet_settings: Set worksheet settings\n- format_chart: Format a chart\n\nOPERATION SCHEMAS:\n\n1. set_value:\n{\n  \"op\": \"set_value\",\n  \"target\": string,       // Cell reference (e.g. \"Sheet1!A1\")\n  \"value\": any            // Value to set (string, number, boolean)\n}\n\n2. add_formula:\n{\n  \"op\": \"add_formula\",\n  \"target\": string,       // Cell reference (e.g. \"Sheet1!A1\")\n  \"formula\": string       // Formula to add (e.g. \"=SUM(B1:B10)\")\n}\n\n3. create_chart:\n{\n  \"op\": \"create_chart\",\n  \"range\": string,        // Range for chart data (e.g. \"Sheet1!A1:D10\")\n  \"type\": string,         // Chart type (e.g. \"columnClustered\", \"line\", \"pie\")\n  \"title\": string,        // Optional chart title\n  \"position\": string      // Optional position (e.g. \"Sheet1!F1\")\n}\n\n4. format_range:\n{\n  \"op\": \"format_range\",\n  \"range\": string,        // Range to format (e.g. \"Sheet1!A1:D10\")\n  \"style\": string,        // Optional number format (e.g. \"Currency\", \"Percentage\")\n  \"bold\": boolean,        // Optional bold formatting\n  \"italic\": boolean,      // Optional italic formatting\n  \"fontColor\": string,    // Optional font color\n  \"fillColor\": string,    // Optional fill color\n  \"fontSize\": number,     // Optional font size\n  \"horizontalAlignment\": string, // Optional alignment (e.g. \"left\", \"center\", \"right\")\n  \"verticalAlignment\": string    // Optional alignment (e.g. \"top\", \"center\", \"bottom\")\n}\n\n5. clear_range:\n{\n  \"op\": \"clear_range\",\n  \"range\": string,        // Range to clear (e.g. \"Sheet1!A1:D10\")\n  \"clearType\": string     // Optional clear type (e.g. \"all\", \"formats\", \"contents\")\n}\n\n6. create_table:\n{\n  \"op\": \"create_table\",\n  \"range\": string,        // Range for table (e.g. \"Sheet1!A1:D10\")\n  \"hasHeaders\": boolean,  // Optional whether first row contains headers\n  \"styleName\": string     // Optional table style name\n}\n\n7. sort_range:\n{\n  \"op\": \"sort_range\",\n  \"range\": string,        // Range to sort (e.g. \"Sheet1!A1:D10\")\n  \"sortBy\": string,       // Column to sort by (e.g. \"A\", \"B\", \"C\")\n  \"sortDirection\": string, // Sort direction (e.g. \"ascending\", \"descending\")\n  \"hasHeaders\": boolean   // Optional whether first row contains headers\n}\n\n8. filter_range:\n{\n  \"op\": \"filter_range\",\n  \"range\": string,        // Range to filter (e.g. \"Sheet1!A1:D10\")\n  \"column\": string,       // Column to filter (e.g. \"A\", \"B\", \"C\")\n  \"criteria\": string      // Filter criteria (e.g. \">0\", \"=Red\", \"<>0\")\n}\n\n9. create_sheet:\n{\n  \"op\": \"create_sheet\",\n  \"name\": string,         // Name for the new sheet\n  \"position\": number      // Optional position (0-based index)\n}\n\n10. delete_sheet:\n{\n  \"op\": \"delete_sheet\",\n  \"name\": string          // Name of the sheet to delete\n}\n\n11. copy_range:\n{\n  \"op\": \"copy_range\",\n  \"source\": string,       // Source range (e.g. \"Sheet1!A1:D10\")\n  \"destination\": string   // Destination cell (e.g. \"Sheet2!A1\")\n}\n\n12. merge_cells:\n{\n  \"op\": \"merge_cells\",\n  \"range\": string         // Range to merge (e.g. \"Sheet1!A1:D1\")\n}\n\n13. unmerge_cells:\n{\n  \"op\": \"unmerge_cells\",\n  \"range\": string         // Range to unmerge (e.g. \"Sheet1!A1:D1\")\n}\n\n14. conditional_format:\n{\n  \"op\": \"conditional_format\",\n  \"range\": string,        // Range to format (e.g. \"Sheet1!A1:D10\")\n  \"type\": string,         // Format type (e.g. \"dataBar\", \"colorScale\", \"iconSet\", \"topBottom\", \"custom\")\n  \"criteria\": string,     // Optional criteria for custom formats\n  \"format\": {             // Optional format settings for custom formats\n    \"fontColor\": string,\n    \"fillColor\": string,\n    \"bold\": boolean,\n    \"italic\": boolean\n  }\n}\n\n15. add_comment:\n{\n  \"op\": \"add_comment\",\n  \"target\": string,       // Cell reference (e.g. \"Sheet1!A1\")\n  \"text\": string          // Comment text\n}\n\n16. set_freeze_panes:\n{\n  \"op\": \"set_freeze_panes\",\n  \"sheet\": string,         // Sheet name\n  \"address\": string        // Cell address to freeze at (e.g. \"B3\")\n  \"freeze\": boolean        // Whether to freeze panes. True if the user wants to freeze panes and false if they want to unfreeze.\n}\n\n17. set_print_settings:\n{\n  \"op\": \"set_print_settings\",\n  \"sheet\": string,         // Sheet name\n  blackAndWhite: boolean,  // Whether to print in black and white\n  draftMode: boolean,      // Whether to print in draft mode\n  firstPageNumber: number, // First page number\n  headings: boolean,       // Whether to display row/column headings when printing\n  orientation: string,     // \"portrait\" or \"landscape\"\n  printAreas: string[],    // Ranges to set as print areas (e.g. [\"A1:H20\", \"A20:H40\"])\n  printComments: string,   // \"none\", \"at_end\", \"as_displayed\"\n  headerMargin: number,    // Header margin in inches\n  footerMargin: number,    // Footer margin in inches\n  leftMargin: number,      // Left margin in inches\n  rightMargin: number,     // Right margin in inches\n  topMargin: number,       // Top margin in inches\n  bottomMargin: number,    // Bottom margin in inches\n  printErrors: string,     // \"blank\", \"dash\", \"displayed\", \"na\"\n  headerRows: number,      // Number of header rows\n  footerRows: number,      // Number of footer rows \n  printTitles: string[],   // Ranges to set as print titles (e.g. [\"A1:H1\", \"A1:H1\"])\n  printGridlines: boolean, // Whether to display gridlines when printing\n}\n\n18. set_page_setup:\n{\n  \"op\": \"set_page_setup\",\n  \"sheet\": string,         // Sheet name\n  \"pageLayoutView\": string,    // \"print\", \"normal\", \"pageBreakPreview\"\n  \"zoom\": number,          // Zoom percentage\n  \"gridlines\": boolean,    // Whether to display gridlines\n  \"headers\": boolean,      // Whether to display row and column headers\n  \"showFormulas\": boolean, // Whether to display formulas instead of values\n  \"showHeadings\": boolean  // Whether to display row and column headings\n}\n\n19. export_to_pdf:\n{\n  \"op\": \"export_to_pdf\",\n  \"sheet\": string,         // Sheet name to export\n  \"fileName\": string,      // Optional name for the PDF file (without extension)\n  \"quality\": string,       // Optional PDF quality: \"standard\" or \"minimal\"\n  \"includeComments\": boolean, // Optional: whether to include comments\n  \"printArea\": string,     // Optional print area to export (e.g., \"A1:H20\")\n  \"orientation\": string,   // Optional page orientation: \"portrait\" or \"landscape\"\n  \"fitToPage\": boolean,    // Optional: whether to fit content to page\n  \"margins\": {             // Optional page margins in points\n    \"top\": number,\n    \"right\": number,\n    \"bottom\": number,\n    \"left\": number\n  }\n}\n\n20. set_worksheet_settings:\n{\n  \"op\": \"set_worksheet_settings\",\n  \"sheet\": string,         // Sheet name\n  \"pageLayoutView\": string,    // \"print\", \"normal\", \"pageBreakPreview\"\n  \"zoom\": number,          // Zoom percentage\n  \"gridlines\": boolean,    // Whether to display gridlines\n  \"headers\": boolean,      // Whether to display row and column headers\n  \"showFormulas\": boolean, // Whether to display formulas instead of values\n  \"showHeadings\": boolean  // Whether to display row and column headings\n  \"position\": int          // index of the sheet in the whole workbook. 0 based.\n  \"enableCalculation\": boolean // Whether to enable calculation\n  \"visibility\": boolean    // Whether to make the sheet visible\n}\n\n21. format_chart:\n{\n  \"op\": \"format_chart\",\n  \"sheet\": string,         // Sheet name\n  \"chart\": string,         // Chart name\n  \"title\": string,         // Chart title\n  \"type\": string,          // Chart type\n  \"dataSource\": string,    // Chart data source cell range address\n  \"legend\": boolean,        // Chart legend\n  \"axis\": boolean,          // Chart axis\n  \"series\": string,        // Chart series\n  \"dataLabels\": boolean,    // Chart data labels\n  \n  // Chart Dimension properties\n  \"width\": number,         // Chart width\n  \"height\": number,        // Chart height\n  \n  // Chart position properties\n  \"left\": number,          // Chart left position\n  \"top\": number,           // Chart top position\n\n    // Chart format properties\n  \"fillColor\": string, // Chart fill color\n  \"borderVisible\": boolean, // Chart border visibility\n  \"borderColor\": string, // Chart border color\n  \"borderWidth\": number, // Chart border width\n  \"borderStyle\": string, // Chart border style\n  \"borderDashStyle\": string, // Chart border dash style\n  \n  // Chart title properties\n  \"titleVisible\": boolean, // Whether title is visible\n  \"titleFontName\": string, // Title font name\n  \"titleFontSize\": number, // Title font size\n  \"titleFontStyle\": string, // Title font style\n  \"titleFontBold\": boolean, // Title font bold\n  \"titleFontItalic\": boolean, // Title font italic\n  \"titleFontColor\": string, // Title font color\n  \"titleFormat\": string, // Title format\n\n  // Legend properties\n  \"legendVisible\": boolean, // Whether legend is visible\n  \"legendFontName\": string, // Legend font name\n  \"legendFontSize\": number, // Legend font size\n  \"legendFontStyle\": string, // Legend font style\n  \"legendFontBold\": boolean, // Legend font bold\n  \"legendFontItalic\": boolean, // Legend font italic\n  \"legendFontColor\": string, // Legend font color\n  \"legendFormat\": string, // Legend format\n\n  // Chart axis properties\n  \"axisVisible\": boolean, // Whether axis is visible\n  \"axisFontName\": string, // Axis font name\n  \"axisFontSize\": number, // Axis font size\n  \"axisFontStyle\": string, // Axis font style\n  \"axisFontBold\": boolean, // Axis font bold\n  \"axisFontItalic\": boolean, // Axis font italic\n  \"axisFontColor\": string, // Axis font color\n  \"axisFormat\": string, // Axis format\n\n  // Chart series properties\n  \"seriesVisible\": boolean, // Whether series is visible\n  \"seriesFontName\": string, // Series font name\n  \"seriesFontSize\": number, // Series font size\n  \"seriesFontStyle\": string, // Series font style\n  \"seriesFontBold\": boolean, // Series font bold\n  \"seriesFontItalic\": boolean, // Series font italic\n  \"seriesFontColor\": string, // Series font color\n  \"seriesFormat\": string, // Series format\n\n  // Chart data labels properties\n  \"dataLabelsVisible\": boolean, // Whether data labels are visible\n  \"dataLabelsFontName\": string, // Data labels font name\n  \"dataLabelsFontSize\": number, // Data labels font size\n  \"dataLabelsFontStyle\": string, // Data labels font style\n  \"dataLabelsFontBold\": boolean, // Data labels font bold\n  \"dataLabelsFontItalic\": boolean, // Data labels font italic\n  \"dataLabelsFontColor\": string, // Data labels font color\n  \"dataLabelsFormat\": string, // Data labels format\n\n}\n\n22. set_calculation_options:\n{\n  \"op\": \"set_calculation_options\",\n  \"calculationMode\": string, // Optional calculation mode (e.g. \"auto\", \"manual\")\n  \"iterative\": boolean,      // Optional whether to enable iterative calculation\n  \"maxIterations\": number,   // Optional maximum number of iterations for iterative calculation\n  \"maxChange\": number,       // Optional maximum change for iterative calculation\n  \"calculate\": boolean,      // Optional whether to calculate the workbook\n  \"calculationType\": string  // Optional calculation type (e.g. \"full\", \"full_recalculate\", \"recalculate\")\n}\n\n23. recalculate_ranges:\n  {\n    \"op\": \"recalculate_ranges\",\n    \"recalculateAll\": boolean, // Optional whether to recalculate all sheets\n    \"sheets\": string[] // List of sheet names to recalculate\n    \"ranges\": string[] // List of cell range addresses to recalculate\n  }\n\nEXAMPLES:\n\nExample 1 - Create a new worksheet (minimal operation):\nUser: \"Add a new tab called Sales\"\n{\n  \"description\": \"Create new Sales worksheet\",\n  \"operations\": [\n    {\n      \"op\": \"create_sheet\",\n      \"name\": \"Sales\"\n    }\n  ]\n}\n\nExample 2 - Set values and add a formula (only what's requested):\nUser: \"Put 10 in cell A1, 20 in cell A2, and calculate the sum in A3\"\n{\n  \"description\": \"Set values and calculate sum\",\n  \"operations\": [\n    {\n      \"op\": \"set_value\",\n      \"target\": \"Sheet1!A1\",\n      \"value\": 10\n    },\n    {\n      \"op\": \"set_value\",\n      \"target\": \"Sheet1!A2\",\n      \"value\": 20\n    },\n    {\n      \"op\": \"add_formula\",\n      \"target\": \"Sheet1!A3\",\n      \"formula\": \"=SUM(A1:A2)\"\n    }\n  ]\n}\n\nExample 3 - Create a chart (only what's requested):\nUser: \"Create a column chart for sales data in range A1:B10 with the title 'Sales Report'\"\n{\n  \"description\": \"Create sales chart\",\n  \"operations\": [\n    {\n      \"op\": \"create_chart\",\n      \"range\": \"Sheet1!A1:B10\",\n      \"type\": \"columnClustered\",\n      \"title\": \"Sales Report\",\n      \"position\": \"Sheet1!D1\"\n    }\n  ]\n}\n\nExample 4 - Format cells (only what's requested):\nUser: \"Format cells B2:B10 as currency and make them bold\"\n{\n  \"description\": \"Format cells as currency and bold\",\n  \"operations\": [\n    {\n      \"op\": \"format_range\",\n      \"range\": \"Sheet1!B2:B10\",\n      \"style\": \"Currency\",\n      \"bold\": true\n    }\n  ]\n}\n\nExample 5 - Freeze panes (single operation):\nUser: \"Freeze the first row\"\n{\n  \"description\": \"Freeze first row\",\n  \"operations\": [\n    {\n      \"op\": \"set_freeze_panes\",\n      \"sheet\": \"Sheet1\",\n      \"row\": 1,\n      \"column\": 0\n    }\n  ]\n}\n\nExample 5a - Freeze panes using cell address:\nUser: \"Freeze panes at cell B3\"\n{\n  \"description\": \"Freeze panes at cell B3\",\n  \"operations\": [\n    {\n      \"op\": \"set_freeze_panes\",\n      \"sheet\": \"Sheet1\",\n      \"address\": \"B3\"      // Use address for cell reference instead of row/column\n    }\n  ]\n}\n\nExample 6 - Multiple explicitly requested operations:\nUser: \"Create a new sheet called 'Summary', copy data from Sheet1!A1:D10 to Summary!A1, and format as currency\"\n{\n  \"description\": \"Create summary sheet with formatted data\",\n  \"operations\": [\n    {\n      \"op\": \"create_sheet\",\n      \"name\": \"Summary\"\n    },\n    {\n      \"op\": \"copy_range\",\n      \"source\": \"Sheet1!A1:D10\",\n      \"destination\": \"Summary!A1\"\n    },\n    {\n      \"op\": \"format_range\",\n      \"range\": \"Summary!A1:D10\",\n      \"style\": \"Currency\"\n    }\n  ]\n}\n\nImportant rules:\n1. ONLY generate operations that the user EXPLICITLY requests - this is the most important rule\n2. Keep the number of operations to the absolute minimum required to fulfill the user's request\n3. Do not add any \"helpful\" operations that weren't requested\n4. Do not populate new worksheets with data unless specifically requested\n5. Always use the exact operation types listed above\n6. Include all required fields for each operation type\n7. Make sure cell references include the sheet name (e.g. \"Sheet1!A1\")\n8. Generate operations in the correct order for execution\n9. Only include fields that are relevant to the operation\n10. Use the most appropriate operation types for the task\n11. Be precise with ranges and cell references\n\nREMEMBER: If the user asks for a simple operation like \"add a new tab named Sales\", your response should ONLY include that specific operation and nothing more. Do not add any data, formatting, or additional operations.\n\nANTI-PATTERNS TO AVOID:\n1. DO NOT create sample data unless explicitly requested\n2. DO NOT create charts or visualizations unless explicitly requested\n4. DO NOT create multiple sheets when only one was requested\n5. DO NOT add operations that seem \"helpful\" but weren't requested\n6. DO NOT respond with string responses like \"I'll perform [action]\" or \"I'll do [this operation]\". Remember that you have to respond only with the JSON schema.\n\n\nWhen in doubt, be minimalist and only do exactly what was asked"
        }
      ]
    },
    {
        "role": "user",
        "content":[
            {
                "type": "input_text",
                "text": "Break down this query: create a table with 3 columns and 5 rows"
            }
        ]
    }
  ],
  reasoning={},
  tools=[],
  temperature=1,
  max_output_tokens=2048,
  top_p=1,
  store=True
)

print(response.text)